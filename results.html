<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Ujian - PERGUNU Situbondo</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="gradient-bg">
    <div id="particles-js"></div>
    <div class="container">
        <div class="results-box">
            <h1>Hasil Ujian Anda</h1>
            
            <div class="results-summary">
                <div class="result-card correct">
                    <h3>Jawaban Benar</h3>
                    <div class="result-value" id="correct-answers">0</div>
                </div>
                
                <div class="result-card wrong">
                    <h3>Jawaban Salah</h3>
                    <div class="result-value" id="wrong-answers">0</div>
                </div>
                
                <div class="result-card skipped">
                    <h3>Terlewat</h3>
                    <div class="result-value" id="skipped-answers">0</div>
                </div>
                
                <div class="result-card score">
                    <h3>Nilai Akhir</h3>
                    <div class="result-value" id="final-score">0</div>
                </div>
            </div>
            
            <div class="motivational-message" id="motivational-message">
                <!-- Filled by JavaScript -->
            </div>
            
            <div class="results-actions">
                <button id="view-certificate" class="btn-primary">Lihat Sertifikat</button>
                <button id="retake-exam" class="btn-secondary">Ulangi Ujian</button>
            </div>
            
            <div class="detailed-results">
                <h2>Detail Jawaban</h2>
                <div class="answers-list" id="answers-list">
                    <!-- Filled by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/particles.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Get exam results
        const results = JSON.parse(localStorage.getItem('examResults'));
        
        // Display results
        document.getElementById('correct-answers').textContent = results.correct;
        document.getElementById('wrong-answers').textContent = results.wrong;
        document.getElementById('skipped-answers').textContent = results.skipped + results.unanswered;
        document.getElementById('final-score').textContent = results.score;
        
        // Set motivational message based on score
        const motivationalMessage = document.getElementById('motivational-message');
        if (results.score >= 90) {
            motivationalMessage.innerHTML = '<h3>Sempurna! Anda sangat luar biasa dalam menguasai materi ini. Pertahankan prestasi ini.</h3>';
        } else if (results.score >= 70) {
            motivationalMessage.innerHTML = '<h3>Bagus! Anda telah menunjukkan pemahaman yang baik. Tingkatkan lagi untuk hasil yang lebih baik.</h3>';
        } else if (results.score >= 50) {
            motivationalMessage.innerHTML = '<h3>Cukup baik. Anda memiliki dasar pemahaman, tetapi perlu belajar lebih giat lagi.</h3>';
        } else {
            motivationalMessage.innerHTML = '<h3>Jangan menyerah! Gunakan hasil ini sebagai motivasi untuk belajar lebih giat lagi.</h3>';
        }
        
        // Generate certificate code
        function generateCertificateCode() {
            const participant = results.participant;
            const exam = results.exam;
            const date = new Date(results.timestamp);
            
            const namePart = participant.fullname.replace(/\s+/g, '').toUpperCase().substring(0, 3);
            const statusPart = participant.status === 'pelajar' ? 'PELAJAR' : 'UMUM';
            const levelPart = participant.status === 'pelajar' ? participant.level : exam.subject.toUpperCase();
            const datePart = date.getDate().toString().padStart(2, '0') + 
                            (date.getMonth() + 1).toString().padStart(2, '0') + 
                            date.getFullYear().toString().substring(2);
            const randomPart = Math.random().toString(36).substring(2, 6).toUpperCase() + '-' + 
                              Math.random().toString(36).substring(2, 6).toUpperCase();
            
            return `${namePart}/${statusPart}/${levelPart}/${datePart}/${randomPart}/PERGUNU-STB`;
        }
        
        // View certificate
        document.getElementById('view-certificate').addEventListener('click', function() {
            // Generate and save certificate code
            const certificateCode = generateCertificateCode();
            results.certificateCode = certificateCode;
            localStorage.setItem('examResults', JSON.stringify(results));
            
            // Play applause sound
            const audio = new Audio('assets/audio/applause.mp3');
            audio.play();
            
            // Redirect to certificate page
            setTimeout(() => {
                window.location.href = 'certificate.html';
            }, 500);
        });
        
        // Retake exam
        document.getElementById('retake-exam').addEventListener('click', function() {
            window.location.href = 'exam-selection.html';
        });
        
        // Display detailed answers
        const answersList = document.getElementById('answers-list');
        // This would be filled with actual questions and answers from the exam
        // For brevity, we'll just show a sample
        answersList.innerHTML = `
            <div class="answer-item correct">
                <div class="answer-question">1. Berapakah hasil dari 2 + 2 Ã— 2?</div>
                <div class="answer-detail">Jawaban Anda: <span class="answer-correct">A (6)</span></div>
                <div class="answer-explanation">Penjelasan: Menurut aturan operasi matematika, perkalian harus dikerjakan terlebih dahulu sebelum penjumlahan.</div>
            </div>
            <div class="answer-item wrong">
                <div class="answer-question">2. Ibu kota Indonesia adalah...</div>
                <div class="answer-detail">Jawaban Anda: <span class="answer-wrong">B (Surabaya)</span> | Jawaban benar: A (Jakarta)</div>
                <div class="answer-explanation">Penjelasan: Jakarta adalah ibu kota Indonesia sejak tahun 1945.</div>
            </div>
        `;
    </script>
</body>
</html>
